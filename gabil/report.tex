\documentclass[10pt, spanish]{article}
\usepackage[spanish, activeacute]{babel}
\usepackage[latin1]{inputenc}
\usepackage{graphicx}

\begin{document}
\title{Universidad Simón Bolívar \\ Inteligencia II \\ Tarea 2}
\author{
  Daniel Barreto - \#04-36723 \texttt{<daniel.barreto.n@gmail.com>} \\
  Kristoffer Pantic - \#05-38675 \texttt{<kristoffer.pantic@gmail.com>}
}
\maketitle

\section{Algorítmo Genético}

\subsection{Descripción de la implementación}
\label{sec:impl}
Se realizó una implementación completa del algorítmo genético, sin
utilizar ninguna librería con alguna implementación.\\

La implementación fué estrucutrada principalmente de la siguiente
forma:

\begin{itemize}
\item Un controlador de corridas del algorítmo (\emph{main.cpp})
  encargado de iniciar la población base y correr iteraciones para ir
  evolucionando dicha población, reportando los mejores fitness
  obtenidos en cada iteración y manteniendo el mejor fitness obtenido
  en toda la corrida.

\item Dos estructuras \textbf{\texttt{population\_t}} y
  \textbf{\texttt{hypothesis\_t}} que modelan una población y una
  hipótesis (conjunto de reglas) respectivamente. La primera se
  encarga de mantener un arreglo de hipótesis e ir produciendo nuevas
  generaciones conservando cierta cantidad de padres y generando el
  resto de hijos con algún algorítmo de \emph{crossover}. Por otra
  parte \texttt{hypothesis\_t} mantiene un arreglo de reglas y tiene
  métodos para calcular su \emph{fitness}, para mutarlas y aplicarle
  las extensiones que son operadores genéticos relativos a una sola
  hipótesis.

\item Una estructura base de regla llamado \textbf{\texttt{rule\_t}}
  que posee únicamente dos \texttt{unsigned long} los cuales se
  utilizan para mantener los bits que representan en ADN de la
  regla. La representación de una regla es explicada más adelante en
  la sección \ref{sec:reglas}.

\item Una librería con los algorítmos de selección implementados, la
  cual se encuentra en el archivo \emph{ga\_variants.cpp}.
\end{itemize}


\subsection{Descripción de los parámetros base}
\label{sec:parambase}
El algorítmo se corrió con varios parámetros inicialmente, pero al
momento de realizar los experimentos reportados se tomó una población
de 200 individuos y la condición de parada de las iteraciones se
estableció como un máximo de 40 iteraciones.

\subsection{Representación de las reglas}
\label{sec:reglas}
Las reglas son una modelación de los 12 atributos estudiados: Age(4),
Workclass(8), Education-num(5), Marital-status(7), Occupation(14),
Relationship(6), Race(5), Sex(2), Capital-gain(4), Capital-loss(3),
Hours-per-week(4) y Native-country(41), unido con la classificación
del individuo(1). Los números en paréntesis al lado derecho de cada
atributo representan la cantidad de bits necesaria para almacenarlo,
lo que dá un total de 104 bits por regla.

Para los atributos contínuos se generaron gráficas que describen la
cantidad de personas que ganan mas de \$50K mensualmente y con esto se
crearon intervalos discretos que se describen a continuación:

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/concentrations_age.png}
  \caption{Age: Intervalos (0,30), (31,55), (56,72), (73,90)}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/concentrations_educ.png}
  \caption{Education-num: Intervalos (0,8), (9,10), (11,12), (13,14), (15,16)}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/concentrations_gain.png}
  \caption{Capital-gain: Intervalos (0,6000), (6001,11600), (11601,18000), (18001,99999)}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/concentrations_loss.png}
  \caption{Capital-loss: Intervalos (0,1500), (1501,2500), (2501,4356)}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/concentrations_hpw.png}
  \caption{Hours-per-week: Intervalos (0,39), (40), (41,52), (53,99)}\label{fig:nodos}
\end{figure}


\section{Experimentos Realizados}
\label{sec:experimentos}
Para determinar cuál es la mejor configuración posible de operadores de selección,
tasas de mutación, tasas de crossover y operadores de extensión se realizaron 3 fases
de experimentos las cuales son descritas a continuación.
\subsection{Descripción}
\label{sec:exp-desc}

\textbf{Fase 1: }\\
Se realizaron pruebas con cada operador de selección para determinar cuál retornaba
el mejor valor promedio de fitness luego de realizar 10 corridas del algoritmo
limitando el número de generaciones producidas a 40. \\
Estas pruebas se realizaron utilizando 3 operadores de selección: 
\begin{itemize}
  \item \textbf{Roulette Wheel Selection: }Se seleccionan los individuos de la población
    de acuerdo a una probabilidad dada al dividir el fitness de un individuo entre
    la sumatoria del fitness de todos los individuos de la población.
  \item \textbf{Rank Selection: }Se ordena de forma descendente la lista de individuos 
    de la población según su fitness y se selecciona un individuo de acuerdo a una 
    probabilidad que depende de su posición en el arreglo y un valor fijado previamente 
    usando la siguiente fórmula $\ p*(1-p)^{i} $ donde i es la posición del individuo 
    en la lista y p la probabilidad selecionada.
  \item \textbf{Top Percent Selection: }Se ordena de forma descendente la lista de individuos
    de la población según su fitness y se toman del principio de la lista la cantidad
    de inviduos a seleccionar.
\end{itemize}
   \textbf{Fase 2: }\\
Una vez seleccionado el mejor operador de selección se procedió a calcular cuál combinación 
de tasas de mutación y de crossover retornaban los mejores resultados en cuanto al fitness
de la población final por lo tanto se tomaron tres valores distintos para cada tasa y se
realizó la prueba con todas las combinaciones posibles.\\
Se consideraron los valores 0.02, 0.06 y 0.1 para la tasa de mutación y los valores 0.4,
0.6 y 0.9 para la tasa de crossover y se utilizó el mismo esquema de corridas que en la
Fase 1.\\
\newline
\textbf{Fase 3: }\\
Al tener las mejores tasas seleccionadas así como el mejor algoritmo de selección era necesario
considerar las extensiones al algoritmo GABIL y su uso y utilidad en función del promedio de fitness
resultantes. 
Para éste experimento consideramos los mejores fitness promedios de la población resultante al aplicar
cada una de las extensiones individualmente y al usar las dos para analizar su efecto sobre la evolución.
En este caso se realizaron menos corridas, se utilizó una población más pequeña y se generaron
menos generaciones por falta de tiempo y recursos.
\subsection{Análisis de resultados}
\label{sec:analisis-resultados}
\textbf{Fase 1}\\
De la experimentación con los tres tipos de selección se obtuvieron los siguientes promedios de fitness:
\begin{itemize}
  \item Roulette Wheel: 56.01\%
  \item Top Percent: 52.01\%
  \item Rank Selection: 25.5\%
\end{itemize}
De estos resultados y del tiempo de ejecución de cada algoritmo pudimos concluir que debido a la superioridad
en cuanto al fitness generado en el caso de Roulette Wheel así como su poco tiempo de ejecución comparado
con el requerido por Top Percent el primero es la mejor opción para ser usado como algoritmo de selección.
\\
\newline
\textbf{Fase 2}\\
Se realizaron pruebas para los siguientes conjuntos de tasas de
mutación y de tasa de \emph{crossover}:

\begin{itemize}
\item \textbf{Tasa de mutación (mc): [0.02, 0.06, 0.1]}
\item \textbf{Tasa de crossover (ncp): [0.4, 0.6, 0.9]}
\end{itemize}

Los resultados, agrupados para cada tasa de mutación se muestran a
continuación:

\emph{Tasa de mutación 0.02}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/200-0-02-0-4.png}
  \caption{Mejor fitness obtenido: 0.081313836}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/200-0-02-0-6.png}
  \caption{Mejor fitness obtenido: 0.049098863946}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/200-0-02-0-9.png}
  \caption{Mejor fitness obtenido: 0.083127128}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  \includegraphics[scale=0.5]{media/0-02all.png}
  \caption{Las tres tasas de crossover con tasa de mutación 0.02}\label{fig:nodos}
\end{figure}

\emph{Tasa de mutación 0.06}
\begin{figure}[htp]
  \centering
%  \includegraphics[scale=0.5]{media/200-0-06-0-4.png}
  \caption{Mejor fitness obtenido: 0.077313836}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
 % \includegraphics[scale=0.5]{media/200-0-06-0-6.png}
  \caption{Mejor fitness obtenido: 0.07906946}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/200-0-06-0-9.png}
  \caption{Mejor fitness obtenido: 0.082127128}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/0-06all.png}
  \caption{Las tres tasas de crossover con tasa de mutación 0.06}\label{fig:nodos}
\end{figure}

\emph{Tasa de mutación 0.1}
\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/200-0-1-0-4.png}
  \caption{Mejor fitness obtenido: 0.03913476}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/200-0-1-0-6.png}
  \caption{Mejor fitness obtenido: 0.059093477}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/200-0-1-0-9.png}
  \caption{Mejor fitness obtenido: 0.080094328}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/0-1all.png}
  \caption{Las tres tasas de crossover con tasa de mutación 0.1}\label{fig:nodos}
\end{figure}

Después de analizar los resultados obtuvimos que la mejor combinación
de tasas mutación y crossover es 0.02 y 0.9 respectivamente.

\textbf{Fase 3}\\
Los resultados obtenidos con cada una de las extensiones por separado
y con las dos al mismo tiempo fueron los siguientes:

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/200-0-02-0-9-add-alternative.png}
  \caption{Usando el operador \emph{AddAlternative}}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/200-0-02-0-9-drop-condition.png}
  \caption{Usando el operador \emph{DropCondition}}\label{fig:nodos}
\end{figure}

\begin{figure}[htp]
  \centering
  %\includegraphics[scale=0.5]{media/both-extensions.png}
  \caption{Usando ambos operadores}\label{fig:nodos}
\end{figure}

\section{Conclusiones}
\label{sec:conclusiones}

\subsection{¿Cuál es la mejor configuración del algorítmo genético para clasificar los datos estudiados?}
\label{sec:preg1}
La mejor configuración conseguida fué utilizar tasa de mutación
\emph{0.02}, tasa de crossover \emph{0.9} y ninguna de las
extensiones.

\subsection{¿Son útiles los operadores de extensión?}
\label{sec:preg2}
En función de los resultados obtenidos podemos concluir que los operadores de extensión
no mejoran el fitness de nuestro algoritmo genético en nuestros casos de prueba. 
Se puede ver además por los resultados que el efecto del operador Add Alternative es mucho 
mejor al que provee el operador Drop Condition.

\subsection{¿Cuál es el mejor conjunto de reglas hallado por el algorítmo genético?}
\label{sec:preg3}
El mejor conjunto de reglas hallado fué el siguiente:
\newline
El resultado obtenido sobre el conjunto de prueba fué: 58.51\% de
clasificados correctamente.
\newpage
\begin{verbatim}
Regla0: p1_ = 8779741078549245919 p2 = 4660554968710733537              
Regla1: p1_ = 3751345646246976735 p2 = 6932518533492325064              
Regla2: p1_ = 8521425960735050762 p2 = 5801565261465785974              
Regla3: p1_ = 8962154459926125200 p2 = 2806380010285285089              
Regla4: p1_ = 8363031664675333599 p2 = 4660554969343727222              
Regla5: p1_ = 8962154459871542751 p2 = 2806380010285285089              
Regla6: p1_ = 8774639275272644063 p2 = 4660554968715181764              
Regla7: p1_ = 8525173354630995151 p2 = 5801565261465785974              
Regla8: p1_ = 9223372030124457983 p2 = 7421896783161196257              
Regla9: p1_ = 6340889511464084959 p2 = 4660554968710733537              
Regla10: p1_ = 6365530130076556493 p2 = 6023832933409709793             
Regla11: p1_ = 6365530133946039540 p2 = 8683868976262897377             
Regla12: p1_ = 6365530124369287824 p2 = 6891492448011214847             
Regla13: p1_ = 9223334010469767824 p2 = 5801565261465788129             
Regla14: p1_ = 6365530124369287824 p2 = 3230970285598663917             
Regla15: p1_ = 9223334629549237759 p2 = 3230970285598662369             
Regla16: p1_ = 9223334629549237759 p2 = 7421896783161196257             
Regla17: p1_ = 6340889511464084959 p2 = 4660554968710733537             
Regla18: p1_ = 9223369835396169215 p2 = 4660554968710733537             
Regla19: p1_ = 8525173354630995151 p2 = 3230924667911542390             
Regla20: p1_ = 9223334629549237759 p2 = 4660554968710733537             
Regla21: p1_ = 9223372030066810063 p2 = 3230970285283827425             
Regla22: p1_ = 8962154459867604479 p2 = 2806380010285285089             
Regla23: p1_ = 8363031664675333599 p2 = 3230970285916821110             
Regla24: p1_ = 9223334629549237759 p2 = 7421896783161196257             
Regla25: p1_ = 6340889511464084959 p2 = 4660554968710733537             
Regla26: p1_ = 8646735360197909983 p2 = 7421896783161196257             
Regla27: p1_ = 6340889511464084959 p2 = 4660554968710733537             
Regla28: p1_ = 3751345646246976717 p2 = 6932518533492325064             
Regla29: p1_ = 8521425960735050762 p2 = 8683869022982903414             
Regla30: p1_ = 6365530124369287824 p2 = 6891492448011214847             
Regla31: p1_ = 9223334010469767824 p2 = 5801565261465788129             
Regla32: p1_ = 5828080307870653072 p2 = 3230970225154285281             
Regla33: p1_ = 8962154459867604479 p2 = 2806380010285285089             
Regla34: p1_ = 8363031664675333599 p2 = 6932518533547562614             
Regla35: p1_ = 8521425960735050762 p2 = 3230970285598663916             
Regla36: p1_ = 9223334629549237759 p2 = 7421896783161196257             
Regla37: p1_ = 9223372030066810063 p2 = 3230970285283827425             
Regla38: p1_ = 8962154459867604479 p2 = 2806380010285285089             
Regla39: p1_ = 8363031664675333599 p2 = 3230970285916821110             
Regla40: p1_ = 9223334629549237759 p2 = 7421896783161196257             
Regla41: p1_ = 6340889511464084959 p2 = 2806380066193235681             
Regla42: p1_ = 6365530124369274335 p2 = 3230970285598663917             
Regla43: p1_ = 9223334629549237759 p2 = 7762516822467763937             
Regla44: p1_ = 8521425952410124682 p2 = 8683869022982903414             
Regla45: p1_ = 6365530124369287824 p2 = 6891492448011214847             
Regla46: p1_ = 9223334010469767824 p2 = 5801565261465788129             
Regla47: p1_ = 9106278444118302431 p2 = 2806380010285285089             
Regla48: p1_ = 8774639275272644063 p2 = 4660554968714952388             
Regla49: p1_ = 8779741078549265871 p2 = 4660554968710733537             
Regla50: p1_ = 8962154459871542751 p2 = 6023202054567761521             
Regla51: p1_ = 6441526891196579060 p2 = 4660554968710733537             
Regla52: p1_ = 8962154459871542751 p2 = 2806380010285285089             
Regla53: p1_ = 6365530134007931959 p2 = 4072182957835509473             
Regla54: p1_ = 9223334629549237759 p2 = 7762516822467763937             
Regla55: p1_ = 5828080307872678282 p2 = 4660554968710733537             
Regla56: p1_ = 3751345646246976717 p2 = 6932518533492325064             
Regla57: p1_ = 8521425960735050762 p2 = 5801565261465785974             
Regla58: p1_ = 6365530124369287824 p2 = 3230970285598663917             
Regla59: p1_ = 8962154459871542783 p2 = 2806380010285285089             
Regla60: p1_ = 8962154459871653855 p2 = 4072182957835509473             
Regla61: p1_ = 9223334629549237759 p2 = 7762516822467763937             
Regla62: p1_ = 5828080307872678282 p2 = 4660554968710733537             
Regla63: p1_ = 3751345646246976717 p2 = 6932518533492325064             
Regla64: p1_ = 8521425960735050762 p2 = 5801565261465785974             
Regla65: p1_ = 6365530124369287824 p2 = 3230970285598663917             
Regla66: p1_ = 8962154459871542783 p2 = 2806380010285285089             
Regla67: p1_ = 8962154459871653855 p2 = 2806380010285285089             
Regla68: p1_ = 6340889511464084959 p2 = 4660554968710733537             
Regla69: p1_ = 9223369835396169215 p2 = 7759031512341634785             
Regla70: p1_ = 5828080307872678282 p2 = 6932518533492326113             
Regla71: p1_ = 8521425960735050762 p2 = 5801565261465785974             
Regla72: p1_ = 8779741009292918751 p2 = 2806380010285285060             
Regla73: p1_ = 8521425960735049183 p2 = 8683868976262897398             
Regla74: p1_ = 6365530124369287824 p2 = 6891492448011214847             
Regla75: p1_ = 9223334010469767824 p2 = 5801565261465788129             
Regla76: p1_ = 6365530124369287824 p2 = 3230970285598663917             
Regla77: p1_ = 9223334629549237759 p2 = 4660554968740134625             
Regla78: p1_ = 6365530130230009039 p2 = 3230970285598663917             
Regla79: p1_ = 9223334629549237759 p2 = 7421896783161196257             
Regla80: p1_ = 6340889511464084959 p2 = 4660554968710733537             
Regla81: p1_ = 6365530130076556493 p2 = 7762516822467763937
Regla82: p1_ = 5828080307872678282 p2 = 4660554965043854025
Regla83: p1_ = 3751345646246976717 p2 = 6932518533492325064
Regla84: p1_ = 8521425960735050762 p2 = 6932518533547562614
Regla85: p1_ = 8521425960735050762 p2 = 3230970285598663916
Regla86: p1_ = 8521425960735057407 p2 = 5801565261465785974
Regla87: p1_ = 6365530124369287824 p2 = 3230970285598663917
Regla88: p1_ = 8962154459871542783 p2 = 2806380010285285089
Regla89: p1_ = 8962154459871653855 p2 = 2806380010285285089
Regla90: p1_ = 6340889511464084959 p2 = 4660554968710733537
Regla91: p1_ = 9223369835396169215 p2 = 6894340383886499553
Regla92: p1_ = 9223334010469767824 p2 = 5801565261465788129
Regla93: p1_ = 6365530124369287824 p2 = 3230970285598663917
Regla94: p1_ = 9223334629549237759 p2 = 7421896783161196257
Regla95: p1_ = 6340889511464084959 p2 = 6985720464485105377
Regla96: p1_ = 8521425960735050762 p2 = 8683869022982903414
Regla97: p1_ = 6365530124369287824 p2 = 3230970285598663917
Regla98: p1_ = 8962154459867604479 p2 = 1664503238123060961
Fitness Test: 0.585134

\end{verbatim}
\end{document}